/*! qit.js v0.9.0 (c) 2015 Hiroyuki OHARA @license MIT */
(function(t,i,e){if(typeof define==="function"&&define.amd){define([],e)}else if(typeof exports==="object"){module.exports=e()}else{t[i]=e()}})(this,"qit",function(t){"use strict";var i=Object.getPrototypeOf,e=Object.prototype,n=Array.prototype.slice,r=e.toString,s=Object().toString(),u=this||(0,eval)("this"),h=u.Symbol?u.Symbol:{iterator:"@@iterator"},f=u.qoo?u.qoo:false;function o(t){var n,u;if(!t||typeof t!=="object"||r.call(t)!==s){return false}n=i(t);if(n===null){u=t.constructor;if(typeof u!=="function")return true;return u.prototype!==t}return n===e||i(n)===null}function c(t,i,e){var n=i.prototype;t.prototype=Object.create(n,{constructor:{value:t,enumerable:false,writable:true,configurable:true}});if(i._inherit_)i._inherit_.call(i,t);t.super_=i;t._super_=n;if(e)a(t,e);return t}function a(t,i){var e,n=t.prototype;for(e in i)n[e]=i[e]}function l(t,i,e){return new w(t,i,e)}function d(t){var i,e=[];for(var i=0,n=t.length;i<n;++i){e.push(new w(t[i]))}return e}function w(i,e,n){if(e!==t){if(typeof e==="function"){this.iter=new _(i,e)}else if(typeof i==="number"&&typeof e==="number"){this.iter=new y(i,e,n)}}else if(i instanceof w){i.rewind();return i}else if(typeof i==="string"){this.iter=new p(i)}else if(Array.isArray(i)){this.iter=new x(i)}else if(o(i)){if(i.next&&typeof i.next==="function"){this.iter=i}else{this.iter=new v(i)}}else if(i[h.iterator]){this.iter=i[h.iterator].call(i)}else{this.iter=i}this.rewind()}w.prototype[h.iterator]=function(){return this};a(w,{_next:function(){if(this.finished)return{done:true};var t=this.iter.next();if(t.done)this.finished=true;return t},next:function(){return this._next()},rewind:function(){this.finished=false;if(this.iter&&this.iter.rewind)this.iter.rewind();return this},each:function(t){var i;while(i=this.next(),!i.done)t(i.value)},reduce:function(i,e){var n,r=e;if(e===t){n=this.next();if(n.done)return r;r=n.value}while(n=this.next(),!n.done){r=i(r,n.value)}return r},toArray:function(){return this.reduce(function(t,i){t.push(i);return t},[])},head:function(i){return t},concat:function(t){return new b([this].concat(n.call(arguments)))},map:function(t){return new g(this,t)},take:function(t){return new F(this,0,t)},drop:function(t){return new F(this,t)},filter:function(t){return new I(this,t)},takeWhile:function(t){return new m(this,t)},dropWhile:function(t){return new j(this,t)},scan:function(t,i){return new k(this,t,i)},zipWith:function(t,i){return new O([this].concat(n.call(arguments,1)),t)},zipWithLongest:function(t,i){return new O([this].concat(n.call(arguments,1)),t,true)},zip:function(t){return new O([this].concat(n.call(arguments)))},zipLongest:function(i){return new O([this].concat(n.call(arguments)),t,true)},cycle:function(){return new S(this)},buffered:function(t){return new A(this,t)},chunk:function(t){return new W(this,t)}});if(f)f.classify(w);function p(t){this.str=t;this.len=t.length;this.rewind()}c(p,w,{rewind:function(){this.idx=0;return p._super_.rewind.call(this)},next:function(){if(this.idx>=this.len){this.finished=true;return{done:true}}return{value:this.str[this.idx++],done:false}}});function x(t){this.arr=t;this.len=t.length;this.rewind()}c(x,w,{rewind:function(){this.idx=0;return x._super_.rewind.call(this)},next:function(){if(this.idx>=this.len){this.finished=true;return{done:true}}return{value:this.arr[this.idx++],done:false}}});function v(t){this.obj=t;this.keys=Object.keys(t);this.len=this.keys.length;this.rewind()}c(v,w,{rewind:function(){this.idx=0;return v._super_.rewind.call(this)},next:function(){if(this.idx>=this.len){this.finished=true;return{done:true}}var t=this.keys[this.idx++];return{value:{key:t,value:this.obj[t]},done:false}}});function _(t,i){this.first=t;this.func=i;this.rewind()}c(_,w,{rewind:function(){this.isFirst=true;this.curr=null;return _._super_.rewind.call(this)},next:function(){if(this.isFirst){this.isFirst=false;this.curr=this.first===t?this.func():this.first}else{this.curr=this.func(this.curr)}if(this.curr===t){this.finished=true;return{done:true}}return{value:this.curr,done:false}}});function y(i,e,n){this.first=i;if(n===t){this.last=e;this.step=i<=e?1:-1}else{this.last=n;this.step=e-i}this.rewind()}c(y,w,{rewind:function(){this.curr=this.first;return y._super_.rewind.call(this)},next:function(){if(this.step>0&&this.curr>this.last||this.step<0&&this.curr<this.last){this.finished=true;return{done:true}}var t=this.curr;this.curr+=this.step;return{value:t,done:false}}});function b(t){this.iters=d(t);this.rewind()}c(b,w,{rewind:function(){this.idx=0;this.len=this.iters.length;for(var t=0,i=this.len;t<i;++t){this.iters[t].rewind()}return b._super_.rewind.call(this)},next:function(){var t=this.iters[this.idx].next();if(!t.done)return t;do{if(++this.idx>=this.len){this.finished=true;return{done:true}}t=this.iters[this.idx].next()}while(t.done);return t}});function g(t,i){this.iter=t;this.func=i;this.rewind()}c(g,w,{next:function(){var t=this._next();if(t.done)return t;return{value:this.func(t.value),done:false}}});function F(t,i,e,n){this.iter=t;this.offset=i;this.len=e;this.norewind=n;this.rewind()}c(F,w,{rewind:function(){this.isFirst=true;this.idx=0;if(!this.norewind)return F._super_.rewind.call(this);this.finished=false;return this},next:function(){var i,e;if(this.isFirst){for(e=0;e<this.offset;++e){i=this._next();if(i.done)return i}this.isFirst=false}if(this.len===t||this.idx<this.len){i=this._next();this.idx++;if(!i.done)return i}this.finished=true;return{done:true}}});function I(t,i){this.iter=t;this.func=i;this.rewind()}c(I,w,{next:function(){var t;do{t=this._next();if(t.done)return t}while(!this.func(t.value));return t}});function m(t,i){this.iter=t;this.func=i;this.rewind()}c(m,w,{next:function(){var t;t=this._next();if(t.done||this.func(t.value))return t;this.finished=true;return{done:true}}});function j(t,i){this.iter=t;this.func=i;this.rewind()}c(j,w,{rewind:function(){this.isFirst=true;return j._super_.rewind.call(this)},next:function(){var t;t=this._next();if(t.done)return t;if(this.isFirst){while(this.func(t.value)){t=this._next();if(t.done)return t}this.isFirst=false}return t}});function k(t,i,e){this.iter=t;this.func=i;this.init=e;this.rewind()}c(k,w,{rewind:function(){this.acc=null;this.isFirst=true;return k._super_.rewind.call(this)},next:function(){var i=this._next();if(!i.done&&this.isFirst){if(this.init===t){this.acc=i.value;i=this._next()}else{this.acc=this.init}this.isFirst=false}if(i.done)return i;this.acc=this.func(this.acc,i.value);return{value:this.acc,done:false}}});function O(t,i,e){this.iters=d(t);this.func=i;this.longest=e;this.rewind()}c(O,w,{rewind:function(){var t,i,e=this.len=this.iters.length;for(t=0;t<e;++t){this.iters[t].rewind()}return O._super_.rewind.call(this)},next:function(){var i,e,n=0,r=this.len,s=[];for(e=0;e<r;++e){i=this.iters[e].next();if(i.done){n++;if(!this.longest||n>=r){this.finished=true;return i}i.value=null}s.push(i.value)}if(this.func===t)return{value:s,done:false};return{value:this.func.apply(this,s),done:false}}});function S(t){this.iter=t;this.rewind()}c(S,w,{next:function(){var t=this._next();if(!t.done)return t;this.rewind();return this._next()}});function A(t,i){this.iter=t;this.len=i;this.rewind()}c(A,w,{rewind:function(){this.isFirst=true;this.buffer=[];return A._super_.rewind.call(this)},head:function(i){i=i===t?0:i;if(this.isFirst)this.prepare();return this.buffer[i]},prepare:function(){var t,i;for(t=0;t<this.len;++t){i=this.iter.next();this.buffer.push(i)}this.isFirst=false},next:function(){if(this.finished)return{done:true};if(this.isFirst)this.prepare();var t=this.iter.next(),i=this.buffer.shift();this.buffer.push(t);if(i.done)this.finished=true;return i}});function W(t,i){this.iter=t;this.len=i}c(W,w,{next:function(){if(this.finished||this.iter.finished){this.finished=true;return{done:true}}var t,i=new F(this.iter,0,this.len,true).buffered(1);t=i.head();if(t.done){this.finished=true;return{done:true}}return{value:i,done:false}}});l.isPlainObject=o;l.Iterator=w;l.StringIterator=p;l.ArrayIterator=x;l.ObjectIterator=v;l.FollowIterator=_;l.RangeIterator=y;l.AppendIterator=b;l.MapIterator=g;l.LimitIterator=F;l.FilterIterator=I;l.TakeWhileIterator=m;l.DropWhileIterator=j;l.ScanIterator=k;l.ZipIterator=O;l.CycleIterator=S;l.BufferedIterator=A;l.ChunkIterator=W;l.Symbol=h;return l});